---
import { Icon } from 'astro-icon/components';

type Socials = Record<string, string | null | undefined>;

type Props = {
  title: string;
  subtitle?: string;
  socials?: Socials;
};

const { title, subtitle, socials = {} } = Astro.props;

const getIconName = (key: string) => {
  // 1. Convert "Google-Plus" to "google-plus"
  const name = key.toLowerCase();

  // 2. Define which keys belong to the 'brands' set
  const brands = [
    'github', 'gitlab', 'google-plus', 'instagram', 
    'linkedin', 'twitter', 'facebook', 'slack', 'dribbble'
  ];

  // 3. Map to the correct Iconify set
  if (brands.includes(name)) {
    return `fa6-brands:${name}`;
  }
  
  // Default to solid for things like 'envelope', 'phone', etc.
  return `fa6-solid:${name}`; 
};

// Filter out empty strings from site.ts
const socialEntries = Object.entries(socials).filter(([, url]) => !!url);
---

<footer id="footer">
  <div class="inner">
    {socialEntries.length > 0 && (
      <ul class="icons">
        {socialEntries.map(([key, url]) => (
          <li>
            <a
              href={url!}
              class="icon alt"
              target="_blank"
              rel="noopener noreferrer"
              aria-label={key}
            >
              <Icon name={getIconName(key)} />
              <span class="label">{key}</span>
            </a>
          </li>
        ))}
      </ul>
    )}

    <ul class="copyright">
      <li>&copy; {title} {subtitle ?? ""}</li>
      <li>Design: <a href="https://html5up.net" target="_blank" rel="noopener noreferrer">HTML5 UP</a></li>
      <li>Astro conversion: Your Name</li>
    </ul>
  </div>
</footer>