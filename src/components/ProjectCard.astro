---
// Import the CollectionEntry type from astro
import type { CollectionEntry } from "astro:content";
import { Image } from "astro:assets";


// Define the interface for your component props
interface Props {
  project: CollectionEntry<"projects">;
  index?: number; // Now it's optional
}

// Destructure the project from Astro.props
const { project, index = 0 } = Astro.props;
const { title, description, tags, image, repoUrl } = project.data;

// If index is odd (1, 3, 5...), we flip the layout
const isOdd = index % 2 !== 0;
---

<section class={`project-card ${isOdd ? "is-odd" : ""}`}>
  <div class="image-container">
    <Image src={image} alt="Banner background" />
  </div>

  <div class="content">
    <div class={`inner ${isOdd ? "is-odd" : ""}`}>
      <header class="major">
        <h2>{title}</h2>
      </header>
      <p>{description}</p>

      <div class="footer-row">
        <ul class="tags">
          {
            tags.map((tag: string) => (
              <li>
                <span class="tag-badge">{tag}</span>
              </li>
            ))
          }
        </ul>
        {
          repoUrl && (
            <div>
              <a href={repoUrl} class="button special">
                Learn more
              </a>
            </div>
          )
        }
      </div>
    </div>
  </div>
</section>

<style lang="scss">
// Definicja zmiennych dla łatwiejszej edycji
$card-bg: rgba(26, 26, 26, 0.1);
$border-color: rgba(33, 33, 33, 0.2);
$text-secondary: #ccc;
$breakpoint-mobile: 768px;

.project-card {
  display: flex;
  background: $card-bg;
  border-radius: 12px;
  overflow: hidden;
  border: 1px solid $border-color;
  padding: 2rem;
  gap: 3rem;
  align-items: center;
  transition: transform 0.2s ease;

  // Selektor zdjęcia
  .image-container {
    flex: 1;
    display: flex;
    justify-content: center;

    img {
      width: 250px;
      height: 250px;
      object-fit: cover;
      border: 4px solid #fff;
      border-radius: 4px;
    }
  }

  // Kontener tekstowy
  .content {
    flex: 2;
    color: #fff;

    h2 {
      margin: 0 0 0.5rem 0;
      font-size: 2rem;
    }

    p {
      color: $text-secondary;
      line-height: 1.6;
      margin-bottom: 1.5rem;
    }
  }

  // Dolna sekcja (tagi i przycisk)
  .footer-row {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 1.5rem;
    margin-top: 1rem;
  }

  .tags {
    display: flex;
    flex-wrap: wrap;
    list-style: none;
    padding: 0;
    margin: 0;
    gap: 8px;

    .tag-badge {
      border: 1px solid #555;
      padding: 4px 12px;
      font-size: 0.75rem;
      border-radius: 4px;
      color: #fff;
    }
  }

  .button.special {
    background: #fff;
    color: #000;
    padding: 0.8rem 1.5rem;
    text-decoration: none;
    font-weight: bold;
    border-radius: 4px;
    display: inline-block;
  }

  // --- LOGIKA DLA ODD (NIEPARZYSTYCH) ---
  &.is-odd {
    flex-direction: row-reverse;

    .inner {
      align-items: flex-end;
      text-align: right;

      .major {
        align-items: flex-end;
        text-align: right;
      }

      .footer-row {
        align-items: flex-end;
      }

      .tags {
        justify-content: flex-end;
      }
    }
  }

  // --- RESPONSYWNOŚĆ ---
  @media (max-width: $breakpoint-mobile) {
    &, &.is-odd {
      flex-direction: column;
      padding: 1.5rem;
      text-align: center;
    }

    .footer-row {
      align-items: center;
      flex-direction: column;
      gap: 1.5rem;
    }
  }
}
